import{isString as p,LoadingIcon as f,wait as v}from"@vuepress/helper/client";import{watchImmediate as k}from"@vueuse/core";import{defineComponent as c,ref as g,shallowRef as h,computed as w,h as r,onMounted as y,watch as d,onUnmounted as C,nextTick as D}from"vue";import{usePageData as M,useSiteData as A}from"vuepress/client";import"artalk/dist/Artalk.css";import{u as B}from"../index-C4kzYjlG.js";var S=c({name:"ArtalkComment",props:{identifier:{type:String,required:!0},darkmode:Boolean},setup(a){const t=B(),l=M(),i=A(),n=g(!1),u=h();let e=null;const s=w(()=>p(t.value.server)),m=async()=>{const[{default:o}]=await Promise.all([import("artalk/dist/Artalk.mjs"),v(t.value.delay??800)]);n.value=!0,await D(),e=o.init({useBackendConf:!1,site:i.value.title,pageTitle:l.value.title,...t.value,el:u.value,pageKey:a.identifier,darkMode:a.darkmode}),t.value.useBackendConf&&e.on("mounted",()=>{e.setDarkMode(a.darkmode)})};return y(()=>{k(()=>t.value,()=>{e?.destroy(),m()},{flush:"post"}),d(()=>a.identifier,()=>{e?.update({site:i.value.title,pageTitle:l.value.title,pageKey:a.identifier}),e?.reload()},{flush:"post"}),d(()=>a.darkmode,o=>{e?.setDarkMode(o)},{flush:"post"})}),C(()=>{e?.destroy()}),()=>s.value?r("div",{class:"artalk-wrapper"},[n.value?null:r(f),r("div",{ref:u})]):null}});export{S as default};
//# sourceMappingURL=ArtalkComment.js.map
